
<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if (IE 9)]><html class="no-js ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html lang="en-US"> <!--<![endif]-->
<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="HandheldFriendly" content="true"/>
    <meta name="MobileOptimized" content="320"/>   
    <meta charset="utf-8">
    <title>Nymote Blog</title>
    
    <meta name="author" content="Nymote">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="/assets/themes/twitter-mod/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter-mod/css/main.css" rel="stylesheet">
    <link href="/assets/themes/twitter-mod/css/supersized.css" rel="stylesheet">
    <link href="/assets/themes/twitter-mod/css/supersized.shutter.css" rel="stylesheet">
    <link href="/assets/themes/twitter-mod/css/fancybox/jquery.fancybox.css" rel="stylesheet">
    <link href="/assets/themes/twitter-mod/css/fonts.css" rel="stylesheet">
    <link href="/assets/themes/twitter-mod/css/shortcodes.css" rel="stylesheet">
    <link href="/assets/themes/twitter-mod/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter-mod/css/responsive.css" rel="stylesheet">
    <link href="/assets/themes/twitter-mod/css/custom.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,300italic,400italic,600,600italic,700,700italic,800,800italic' rel='stylesheet' type='text/css'>

    <!-- ATOM and RSS Feeds -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

    <link href="/images/nymote-logo-blue-large.png" rel="image_src">

  </head>

  <body>

  <!-- NAVIGATION -->

  

<!-- Header -->
<header>
    <div class="sticky-nav">
      <a id="mobile-nav" class="menu-nav" href="#menu-nav"></a>
        
        <div id="logo">
          <a id="goUp" href="/#top"></a>
        </div>
        
        <nav id="menu">
          <ul id="menu-nav">
              <li><a href="/#home" class="external">Home</a></li>
                <li><a href="/#overview" class="external">Overview</a></li>
                <li><a href="/#software" class="external">Software</a></li>
                <li class="current"><a href="/blog">Blog</a></li>
                <li><a href="/#about" class="external">About Us</a></li>
            </ul>
        </nav>
            
    </div>
</header>
<!-- End Header -->

<div id="blog" class="page-alternate">
  <div class="container">
    <div class="row">     
      <div class="span1"></div>
      <div class="span10">
        <div class="title-page">
          <span style="float: right; margin-left: 15px;"><h4><a href="/atom.xml">subscribe <span class="icon-rss"></span></a></h4></span>
          
          <div class="page-header">
            <h1><a class="post-title" href="/blog/2015/brewing-miso-to-serve-nymote">Brewing MISO to serve Nymote</a></h1>
            <span>Posted on 20 January 2015 by Amir Chaudhry</span>
            
          </div>
          <div class="row">
            <div class="span10">
              <div class="title-page">
                <h4 class="title-description"></h4>
                
<p>The <a href="http://nymote.org/blog/2013/introducing-nymote/">mission of Nymote</a> is to enable the creation of resilient
decentralised systems that incorporate privacy from the ground up, so that
users retain control of their networks and data.  To achieve this, we
reconsider all the old assumptions about how software is created in light of
the problems of the modern, networked environment.  Problems that will become
even more pronounced as more devices and sensors find their way into our lives.</p>

<p>We want to make it simple for anyone to be able to run a piece of the cloud
for their own purposes and the first three applications Nymote targets are
Mail, Contacts and Calendars, but to get there, we first have to create solid
foundations.</p>

<h3 id="defining-the-bedrock">Defining the bedrock</h3>

<p>In order to create applications that work for the user, we first have to
create a robust and reliable software stack that takes care of fundamental
problems for us. In other words, to be able to assemble the applications we
desire, we must first construct the correct building blocks.</p>

<p>We’ve taken a clean-slate approach so that we can build long-lasting solutions
with all the benefits of hindsight but none of the baggage. As
mentioned in earlier posts, there are three main components of the stack,
which are: <a href="http://nymote.org/software/mirage/">Mirage</a> (OS for the Cloud/IoT), <a href="http://nymote.org/software/irmin/">Irmin</a> (distributed datastore)
and <a href="http://nymote.org/software/signpost/">Signpost</a> (identity and connectivity) - all built using the <a href="http://ocaml.org">OCaml</a>
programming language.</p>

<h4 id="using-the-miso-stack-to-build-nymote">Using the MISO stack to build Nymote</h4>

<p>As you’ve already noticed, there’s a useful acronym for the above tools —
<strong>MISO</strong>. Each of the projects mentioned is a serious undertaking in its own
right and each is likely to be impactful as a stand-alone concept.  However,
when used together we have the opportunity to create applications and services
with high levels of security, scalability and stability, which are not easy to
achieve using other means. </p>

<p>In other words, MISO is the <em>toolstack</em> that we’re using to build Nymote —
Nymote is the <em>decentralised system</em> that works for its users.</p>

<p>Each of the projects is at a different phase but they have all have made great
strides over the last year.</p>

<h4 id="mirage">Mirage</h4>

<p>Mirage — a library operating system that constructs unikernels — is the most
mature part of the stack. I previously wrote about the
<a href="http://nymote.org/blog/2014/announcing-first-mirage-release/">Mirage 1.0 release</a> and only six months later we had an
<a href="http://openmirage.org/blog/announcing-mirage-20-release">impressive 2.0 release</a>, with continuing advances throughout the year.
We achieved major milestones such as the ability to deploy unikernels to
ARM-based devices, as well as a clean-slate implementation of the transport
layer security (TLS) protocol.</p>

<p>In addition to the development efforts, there have also been many
presentations to audiences, ranging from <a href="http://amirchaudhry.com/describing-miso-entrepreneur-first-2014/">small groups of startups</a>
all the way to <a href="http://media.ccc.de/browse/congress/2014/31c3_-_6443_-_en_-_saal_2_-_201412271245_-_trustworthy_secure_modular_operating_system_engineering_-_hannes_-_david_kaloper.html#video">prestigious keynotes</a> with 1000+ attendees.  Ever
since we’ve had ARM support, the talks themselves have been delivered from
unikernels running on Cubieboards and you can see the growing collection of
slides at <a href="http://decks.openmirage.org">decks.openmirage.org</a>.</p>

<p>All of these activities have led to a tremendous increase in public awareness
of unikernels and the value they can bring to developing robust, modern
software as well as the promise of <a href="https://medium.com/@darrenrush/after-docker-unikernels-and-immutable-infrastructure-93d5a91c849e">immutable infrastructure</a>.
As more people look to get involved and contribute to the codebase, we’ve also
begun curating a set of <a href="https://github.com/mirage/mirage-www/wiki/Pioneer-Projects">Pioneer Projects</a>, which are suitable for a
range of skill-levels.</p>

<p>You can find much more information on all the activities of 2014 in the
comprehensive <a href="http://openmirage.org/blog/2014-in-review">Mirage review post</a>. As it’s the most mature
component of the MISO stack, anyone interested in the <em>development of code</em>
towards Nymote should join the <a href="http://lists.xenproject.org/cgi-bin/mailman/listinfo/mirageos-devel">Mirage mailing list</a>.</p>

<ul>
  <li><em>Source code</em> - <a href="https://github.com/mirage">Mirage org on GitHub</a></li>
</ul>

<h4 id="irmin">Irmin</h4>

<p>Irmin — a library to persist and synchronize distributed data structures —
made significant progress last year. It’s based on the principles of Git, the
distributed version control system, and allows developers to choose the
appropriate combination of consistency, availability and partition tolerance
for their needs.</p>

<p>Early last year Irmin was released as an alpha with the ability to speak
‘fluent Git’ and by the summer, it was supporting user-defined merge
operations and fast in-memory views.  A couple of summer projects improved the
<a href="http://gazagnaire.org/pub/FGM15.pdf">merge strategies</a> and synchronisation strategies, while an
external project — Xenstore — used Irmin to <a href="http://openmirage.org/blog/introducing-irmin-in-xenstore">add fault-tolerance</a>.</p>

<p>More recent work has involved a big clean-up in the user-facing API (with nice
<a href="http://samoht.github.io/irmin/">developer documentation</a>) and a cleaner high-level REST API.
Upcoming work includes proper documentation of the REST API, which means Irmin
can more easily be used in non-OCaml projects, and full integration with
Mirage projects. </p>

<p>Irmin is already being used to create
<a href="https://opam.ocaml.org/packages/imaplet-lwt/imaplet-lwt.0.1.3/">a version controlled IMAP server</a> and
<a href="https://github.com/samoht/dog">a version controlled distributed log system</a>. It’s no surprise
that the first major release is coming <a href="https://github.com/mirage/irmin/issues?q=is%3Aopen+is%3Aissue+milestone%3A1.0.0">very soon</a>!</p>

<ul>
  <li><em>Source code</em> - <a href="https://github.com/mirage/irmin">Irmin on GitHub</a></li>
</ul>

<h4 id="signpost">Signpost</h4>

<p>Signpost will be a collection of libraries that aims to provide identity and
connectivity between devices.  Forming efficient connections between
end-points is becoming ever more important as the number of devices we own
increases. These devices need to be able to recognise and reach each-other,
regardless of their location on the network or the obstacles in between. </p>

<p>This is very much a nascent project and it involves a lot of work on
underlying libraries to ensure that security aspects are properly considered.
As such, we must take great care in how we implement things and be clear about
any trade-offs we make. Our thoughts are beginning to converge on a design we
think will work and that we would entrust with our own data, but we’re
treating this as a case of ‘Here Be Dragons’.  This is a critical piece of the
stack and we’ll share what we learn as we chart our way towards it.</p>

<p>Even though we’re at the design stage of Signpost, we did substantial work
last year to create the libraries we might use for implementation.  A
particularly exciting one is <a href="https://github.com/MagnusS/jitsu">Jitsu</a> — which stands for Just In Time
Summoning of Unikernels. This is a DNS server that spawns unikernels in
response to DNS requests and boots them in real-time with no perceptible lag
to the end user.  In other words, it makes much more efficient use of
resources and significantly reduces latency of services for end-users —
services are only run <em>when</em> they need to be, in the <em>places</em> they need to be. </p>

<p>There’s also been lots of efforts on other libraries that will help us
<em>iterate towards</em> a complete solution. Initially, we will use pre-existing
implementations but in time we can take what we’ve learned and create more
robust alternatives. Some of the libraries are listed below (but note the
friendly disclaimers!). </p>

<ul>
  <li><em>Source code</em>
    <ul>
      <li><a href="https://github.com/dsheets/ocaml-sodium">Bindings to libsodium</a></li>
      <li><a href="https://github.com/dsheets/ocaml-dnscurve">Implementation of DNSCurve</a></li>
      <li><a href="https://github.com/dsheets/ocaml-libmacaroons">Bindings to libmacaroons</a></li>
    </ul>
  </li>
</ul>

<h4 id="ocaml">OCaml</h4>

<p><a href="http://ocaml.org">OCaml</a> is a mature, powerful and highly pragmatic language.  It’s
proven ideal for creating robust systems applications and
<a href="http://ocaml.org/learn/companies.html">many others</a> also recognise this.  We’re using it to create all the
tools you’ve read about so far and we’re also helping to improve the ecosystem
around it.</p>

<p>One of the major things we’ve been involved with is the coordination of the
OCaml Platform, which combines the OCaml compiler with a coherent set of tools
and workflows to be more productive in the language and speed up development
time.  We presented the first major release of these efforts at OCaml 2014 and
you can <a href="http://ocaml.org/meetings/ocaml/2014/ocaml2014_7.pdf">read the abstract</a> or <a href="https://www.youtube.com/watch?v=jxhtpQ5nJHg&amp;list=UUP9g4dLR7xt6KzCYntNqYcw">watch the video</a>.</p>

<p>There’s more to come, as we continue to improve the tooling and also support
the community in <a href="http://amirchaudhry.com/towards-governance-framework-for-ocamlorg">other ways</a>.</p>

<h3 id="early-steps-towards-applications">Early steps towards applications</h3>

<p>Building blocks are important but we also need to push towards working
applications.  There are different approaches we’ve taken to this, which
include building prototypes, wireframing use-cases and implementing features
with other toolstacks.  Some of this work is also part of a larger
<a href="http://usercentricnetworking.eu">EU funded project</a>* and below are brief summaries of the things we’ve
done so far. We’ll expand on them as we do more over time.</p>

<p><strong>Mail</strong> - As mentioned above, a prototype IMAP server exists (<a href="https://opam.ocaml.org/packages/imaplet-lwt/imaplet-lwt.0.1.3/">IMAPlet</a>)
which uses Irmin to store data. This is already able to connect to a client to
serve mail. The important feature is that it’s an IMAP server which is version
controlled in the backend and can expose a REST API from the mailstore quite
easily.</p>

<p><strong>Contacts</strong> - We first made wireframe mockups of the features we might like
in a contacts app (to follow in later post) and then built a
<a href="https://github.com/yansh/contacts-app">draft implementation</a>. To get here, code was first written in OCaml
and then put through the <a href="http://ocsigen.org/js_of_ocaml/">js_of_ocaml</a> compiler. This is valuable as it
takes us closer to a point where we can build networks using our address books
and have the system take care of sharing details in a privacy-conscious manner
and with minimal maintenance. The <a href="http://yansnotes.blogspot.co.uk/2015/01/work-summary-ocaml-labs.html">summary post</a> has more detail.</p>

<p><strong>Calendar</strong> - This use-case was approached in a completely different way as
part of a hackathon last year. A rough but functional prototype was built over
one weekend, with a team formed at the event.  It was centralised but it
tested the idea that a service which integrates intimately with your life (to
the point of being very invasive) can provide disproportionate benefits.  The
<a href="http://seedcamp.com/seedhack-5-0/">experience report</a> describes the weekend and our app — Clarity —
won first place. This was <em>great</em> validation that the features are desirable
so we need to work towards a decentralised, privacy-conscious version.</p>

<h3 id="time-to-get-involved">Time to get involved!</h3>

<p>The coming year represents the best time to be working on the MISO stack and
using it to make Nymote a reality.  All source code is publicly available and
the projects are varied enough that there is something for everyone.  Browse
through issues, consider the <a href="https://github.com/mirage/mirage-www/wiki/Pioneer-Projects">projects</a> or simply write online and
share with us the things you’d like to see.
This promises to be an exciting year!</p>

<p><em>Sign up to the <a href="http://nymote.us5.list-manage.com/subscribe?u=8a83b2d5453bba2ee5838b4ad&amp;id=a41245094c">mailing list</a> to keep up to date!</em></p>

<p><em>* NB The research leading to these results has received
funding from the European Union’s Seventh Framework Programme FP7/2007-2013
under the UCN project, grant agreement no 611001.</em></p>

<!-- ========================================================= -->


                <a href="/blog/2015/brewing-miso-to-serve-nymote/#share-comment"><!-- Share / -->Comment</a>
              </div>
              <hr>
            </div>
          </div>  
          
          <div class="page-header">
            <h1><a class="post-title" href="/blog/2015/unikernels-for-everyone">Unikernels for everyone!</a></h1>
            <span>Posted on 19 January 2015 by Amir Chaudhry</span>
            
          </div>
          <div class="row">
            <div class="span10">
              <div class="title-page">
                <h4 class="title-description"></h4>
                
<p>Many people have now set up unikernels for blogs, documenting their
experiences for others to follow.  Even more important is that people are
going beyond static sites to build unikernels that provide more complicated
services and solve real-world problems.</p>

<p>To help newcomers get started, there are now even more posts that that use
different tools and target different deployment methods.  Below are summaries
of some of the posts I found interesting and that will make it easier for you
try out different ways of creating and deploying your unikernels.</p>

<h3 id="unikernel-blogs-with-mirageos">Unikernel blogs with MirageOS</h3>

<p>Mindy picked up where the <a href="http://amirchaudhry.com/from-jekyll-to-unikernel-in-fifty-lines/">first set of instructions</a>
finished and described her work to get an Octopress blog running on Amazon EC2.
As one of the first people outside the core team to work on this, she had a
lot of interesting experiences — which included getting into the Mirage
networking stack to debug an issue and submit a bugfix!  More recently, she
also wrote a couple of excellent posts on <em>why</em> she uses a unikernel for her
blog.  These posts cover the security concerns (and responsibility) of running
networked services on today’s Internet and the importance of owning your
content — both ideas are at the heart of the work behind <a href="http://nymote.org/">Nymote</a> and are
well worth reading.</p>

<ul>
  <li><em>Mindy’s posts</em>
    <ul>
      <li><em>Overview</em> - <a href="http://www.somerandomidiot.com/blog/2014/08/18/i-am-unikernel/">“I Am Unikernel (and So Can You!)”</a></li>
      <li><em>First in her Mirage series</em> - <a href="http://www.somerandomidiot.com/blog/2014/03/14/its-a-mirage/">“It’s a Mirage! (or, How to Shave a Yak.)”</a></li>
      <li><a href="http://www.somerandomidiot.com/blog/2014/08/11/attack-surface-area/">“Attack Surface: Why I Unikernel, Part 1”</a></li>
      <li><a href="http://www.somerandomidiot.com/blog/2014/08/14/my-content-is-mine/">“My Content Is Mine: Why I Unikernel, Part 2”</a></li>
    </ul>
  </li>
</ul>

<p>Ian took a different path to AWS deployment by using Vagrant and Test Kitchen
to to get his static site together and build his unikernel, and then Packer to
create the images for deployment to EC2.  All succinctly explained with code
available on GitHub for others to try out!</p>

<ul>
  <li><em>Ian on</em> <a href="https://github.com/iw/mirage-jekyll">“Mirage with Jekyll on Amazon EC2”</a></li>
</ul>

<p>Toby wanted to put together a blog that was a little more complicated than a
traditional static site, with specific features like subdomains based on tags
and the ability to set future dates for posts. He also pulled in some other
libraries so he can use Mustache for sever-side rendering, where his blog
posts and metadata are stored as JSON and rendered on request.</p>

<ul>
  <li><em>Toby on</em> <a href="http://ocaml.is-awesome.net/2014/11/building-a-blog-with-mirage-os">“Building a Blog with MirageOS”</a></li>
</ul>

<p>Chris saw others working to get unikernel blogs on EC2 and decide he’d try
getting his up and running on Linode instead.  He is the first person to
deploy his unikernel to Linode and he provided a great walkthough with helpful
screenshots, as well as brief notes about the handful of differences compared
with EC2.  Chris also wrote about the issue he had with clean urls (i.e
serving <code>/about/index.html</code> when a user visits <code>/about/</code>) — he describes the
things he tried out until he was finally able to fix it.  </p>

<ul>
  <li><em>Chris’ posts</em>
    <ul>
      <li><em>Setting up a unikernel</em> - <a href="http://christopherbothwell.com/ocaml/mirage/2014/12/03/about-not-found.html">“About Not Found”</a></li>
      <li><em>Deploying to Linode</em> - <a href="http://christopherbothwell.com/ocaml/mirage/linode/2014/12/08/hello-linode.html">“Hello Linode”</a></li>
    </ul>
  </li>
</ul>

<p>Phil focused on getting unikernels running on a cubieboards, which are ARM
based development boards — similar to the Raspberry Pi. He starts by taking
Mirage’s pre-built <a href="http://blobs.openmirage.org">Cubieboard images</a> — which makes it easy to
get Xen and an OCaml environment set up on the board — and getting this
installed on the Cubieboard.  He also noted the issues he came across along
with the simple tweaks he made to fix them and finally serves a Mirage hello
world page.</p>

<ul>
  <li><em>Phil on</em> <a href="http://philtomson.github.io/blog/2014/09/10/some-notes-on-building-and-running-mirage-unikernels-on-cubieboard2/">“Some Notes on Building and Running Mirage Unikernels on Cubieboard2”</a></li>
</ul>

<h3 id="more-than-just-static-sites">More than just static sites</h3>

<p>Static sites have become the new ‘hello world’ app. They’re simple to manage,
low-risk and provide lots of opportunities to experience something new.  These
aspects make them ideal for discovering the benefits (and trade offs) of the
unikernel approach and I look forward to seeing what variations people come up
with — For instance, there aren’t any public instructions for deploying to
Rackspace so it would be great to read about someone’s experiences there.
However, there are also many other applications that also fit the above
criteria of simplicity, low risk and plentiful learning opportunities. </p>

<p>Thomas Leonard decided to create a unikernel for a simple REST service for
queuing package uploads for 0install.  His post takes you from the very
beginning, with a simple hello world program running on Xen, all the way
through to creating his REST service. Along the way there a lots of code
snippets and explanations of the libraries being used and what they’re doing.
This is a great use-case for unikernels and there are a lot of interesting
things to take from this post, for example the ease with which Thomas was able
to find and fix bugs using regular tools. There’s also lots of information on
performance testing and optimising of the unikernel, which he covers in a
follow-up post, and he even built tools to visualise the traces. </p>

<ul>
  <li><em>Thomas’ posts</em>
    <ul>
      <li><em>Hello world and REST service</em> - <a href="http://roscidus.com/blog/blog/2014/07/28/my-first-unikernel/">“My First Unikernel”</a></li>
      <li><em>Profiling and optimisations</em> - <a href="http://roscidus.com/blog/blog/2014/08/15/optimising-the-unikernel/">“Optimising the Unikernel”</a></li>
      <li><em>Tool to visualise traces</em> - <a href="http://roscidus.com/blog/blog/2014/10/27/visualising-an-asynchronous-monad">“Visualising an Asynchronous Monad”</a></li>
    </ul>
  </li>
</ul>

<p>Of course, there’s much more activity out there than described in this post as
people continually propose ideas on the <a href="http://lists.xenproject.org/cgi-bin/mailman/listinfo/mirageos-devel">Mirage mailing list</a> — both
for things they would like to try out and issues they came up against. In my
<a href="http://nymote.org/blog/2014/from-jekyll-site-to-unikernel/">last post</a>, I pointed out that the workflow is applicable to any
type of unikernel and as Thomas showed, with bit of effort it’s already
possible to create useful, real-world services using the many libraries that
already exist. There’s also a lot of scaffolding in the <a href="https://github.com/mirage/mirage-skeleton">mirage-skeleton</a>
repo that you can build on which makes it even easier to get involved.  If you
want to dive deeper into the libraries and perhaps learn OCaml, there are lots
of <a href="http://ocaml.org/learn/books.html">resources online</a> and <a href="https://github.com/mirage/mirage-www/wiki/Pioneer-Projects">projects</a> to get involved with too.</p>

<p>Now is a great time to try building a unikernel for yourself and as you can
see from the posts above, shared experiences help other people progress
further and branch out into new areas. When you’ve had a chance to try
something out please do share your experiences online! </p>

<!-- ===== LINKS ===== -->


                <a href="/blog/2015/unikernels-for-everyone/#share-comment"><!-- Share / -->Comment</a>
              </div>
              <hr>
            </div>
          </div>  
          
          <div class="page-header">
            <h1><a class="post-title" href="/blog/2014/from-jekyll-site-to-unikernel">From Jekyll site to Unikernel</a></h1>
            <span>Posted on 16 March 2014 by Amir Chaudhry</span>
            
          </div>
          <div class="row">
            <div class="span10">
              <div class="title-page">
                <h4 class="title-description"></h4>
                
<p><a href="http://nymote.org/software/mirage">Mirage</a> has reached a point where it&#8217;s possible to easily set up
end-to-end toolchains to build <a href="http://queue.acm.org/detail.cfm?id=2566628">unikernels</a>! <!--\[If you're not sure what that is, read the post [What is a unikernel?][amc-unikernel]\]-->
My first use-case is to be able to generate a unikernel which can serve my
personal static site but to do it with as much automation as possible. It
turns out this is possible with less than 50 lines of code.</p>

<p>I use Jekyll and GitHub Pages at the moment so I wanted a workflow that&#8217;s as
easy to use, though I&#8217;m happy to spend some time up front to set up and
configure things.
The tools for achieving what I want are in good shape so
this post takes the example of a Jekyll site and goes through
the steps to produce a unikernel on
<a href="https://travis-ci.org">Travis CI</a> (a continuous integration service) which can later be
deployed.  Many of these instructions already exist in various forms but
they&#8217;re collated here to aid this use-case.  </p>

<p>I will take you, dear reader, through the process and when we&#8217;re finished,
the workflow will be as follows:</p>

<ol>
  <li>You&#8217;ll write your posts on your local machine as normal</li>
  <li>A push to GitHub will trigger a unikernel build for each commit</li>
  <li>The Xen unikernel will be pushed to a repo for deployment</li>
</ol>

<p>To achieve this, we&#8217;ll first check that we can build a unikernel VM locally,
then we&#8217;ll set up a continuous integration service to automatically build
them for us and finally we&#8217;ll adapt the CI service to also deploy the built
VM.  Although the amount of code required is small, each of these steps is
covered below in some detail.
For simplicity, I&#8217;ll assume you already have OCaml and Opam
installed &#8211; if not, you can find out how via the
<a href="http://realworldocaml.org/install">Real Word OCaml install instructions</a>.</p>

<h2 id="building-locally">Building locally</h2>

<p>To ensure that the build actually works, you should run things locally at
least once before pushing to Travis.  It&#8217;s worth noting that the
<a href="https://github.com/mirage/mirage-skeleton">mirage-skeleton</a> repo contains a lot of useful, public domain examples
and helpfully, the specific code we need is in
<a href="https://github.com/mirage/mirage-skeleton/tree/master/static_website">mirage-skeleton/static_website</a>.  Copy both the <code>config.ml</code>
and <code>dispatch.ml</code> files from that folder into a new <code>_mirage</code> folder in your
jekyll repository.</p>

<p>Edit <code>config.ml</code> so that the two mentions of <code>./htdocs</code> are replaced with
<code>../_site</code>.  This is the only change you&#8217;ll need to make and you should now
be able to build the unikernel with the unix backend.  Make sure you have
the mirage package installed by running <code>$ opam install mirage</code> and then run:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span><span class="nb">cd </span>_mirage
<span class="nv">$ </span>mirage configure --unix
<span class="nv">$ </span>make depend       <span class="c"># needed as of mirage 1.2</span>
<span class="nv">$ </span>mirage build
<span class="nv">$ </span><span class="nb">cd</span> ..</code></pre></div>

<p>That&#8217;s all it takes!  In a few minutes there will be a unikernel built on
your system (symlinked as <code>_mirage/mir-www</code>).  If there are any errors, make
sure that Opam is up to date and that you have the latest version of the
static_website files from <a href="https://github.com/mirage/mirage-skeleton">mirage-skeleton</a>. </p>

<h3 id="serving-the-site-locally">Serving the site locally</h3>

<p>If you&#8217;d like to see this site locally, you can do so from within the
<code>_mirage</code> folder by running unikernel you just built.  There&#8217;s more
information about the details of this on the <a href="http://openmirage.org/wiki/mirage-www">Mirage docs site</a>
but the quick instructions are:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span><span class="nb">cd </span>_mirage
<span class="nv">$ </span>sudo mirage run

<span class="c"># in another terminal window</span>
<span class="nv">$ </span>sudo ifconfig tap0 10.0.0.1 255.255.255.0</code></pre></div>

<p>You can now point your browser at http://10.0.0.2/ and see your site!
Once you&#8217;re finished browsing, <code>$ mirage clean</code> will clear up all the
generated files. </p>

<p>Since the build is working locally, we can set up a continuous integration
system to perform the builds for us.</p>

<h2 id="setting-up-travis-ci">Setting up Travis CI</h2>
<p><img style="float: right; margin-left: 10px" src="http://amirchaudhry.com/images/jekyll-unikernel/travis.png" />&lt;/img&gt;</p>

<p>We&#8217;ll be using the <a href="https://travis-ci.org">Travis CI</a> service, which is free for open-source
projects (so this assumes you&#8217;re using a public repo).  The benefit of using
Travis is that you can build a unikernel <em>without</em> needing a local OCaml
environment, but it&#8217;s always quicker to debug things locally.</p>

<p>Log in to Travis using your GitHub ID which will then trigger a scan of your
repositories.  When this is complete, go to your Travis accounts page and
find the repo you&#8217;ll be building the unikernel from.  Switch it &#8216;on&#8217; and
Travis will automatically set your GitHub post-commit hook and token for you.
That&#8217;s all you need to do on the website.</p>

<p>When you next make a push to your repository, GitHub will inform Travis,
which will then look for a YAML file in the root of the repo called
<code>.travis.yml</code>.  That file describes what Travis should do and what the build
matrix is.  Since OCaml is not one of the supported languages, we&#8217;ll be
writing our build script manually (this is actually easier than it sounds).
First, let&#8217;s set up the YAML file and then we&#8217;ll examine the build script.</p>

<h3 id="the-travis-yaml-file---travisyml">The Travis YAML file - .travis.yml</h3>

<p>The <a href="http://docs.travis-ci.com/user/ci-environment/#CI-environment-OS">Travis CI environment</a> is based on Ubuntu 12.04, with a
number of things pre-installed (e.g Git, networking tools etc).  Travis
doesn&#8217;t support OCaml (yet) so we&#8217;ll use the <code>c</code> environment to get the
packages we need, specifically, the OCaml compiler, Opam and Mirage. Once
those are set up, our build should run pretty much the same as it did locally.</p>

<p>For now, let&#8217;s keep things simple and only focus on the latest releases
(OCaml 4.01.0 and Opam 1.1.1), which means our build matrix is very simple.
The build instructions will be in the file <code>_mirage/travis.sh</code>, which we
will move to and trigger from the <code>.travis.yml</code> file.  This means our YAML
file should look like:</p>

<div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">language</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">c</span>
<span class="l-Scalar-Plain">before_script</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">cd _mirage</span>
<span class="l-Scalar-Plain">script</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">bash -ex travis.sh</span>
<span class="l-Scalar-Plain">env</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">matrix</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">MIRAGE_BACKEND=xen DEPLOY=0</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">MIRAGE_BACKEND=unix</span></code></pre></div>

<p>The matrix enables us to have parallel builds for different environments and
this one is very simple as it&#8217;s only building two unikernels. One worker
will build for the Xen backend and another worker will build for the Unix
backend. The <code>_mirage/travis.sh</code> script will clarify what each of these
environments translates to.  We&#8217;ll come back to the <code>DEPLOY</code> flag later on
(it&#8217;s not necessary yet).  Now that this file is set up, we can work on the
build script itself.</p>

<h3 id="the-build-script---travissh">The build script - travis.sh</h3>

<p>To save time, we&#8217;ll be using an Ubuntu PPA to quickly get
<a href="https://launchpad.net/~avsm">pre-packaged versions of the OCaml compiler and Opam</a>, so the
first thing to do is define which PPAs each line of the build matrix
corresponds to.  Since we&#8217;re keeping things simple, we only need one PPA
that has the most recent releases of OCaml and Opam.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#!/usr/bin/env bash</span>
<span class="nv">ppa</span><span class="o">=</span>avsm/ocaml41+opam11
<span class="nb">echo</span> <span class="s2">&quot;yes&quot;</span> <span class="p">|</span> sudo add-apt-repository ppa:<span class="nv">$ppa</span>
sudo apt-get update -qq
sudo apt-get install -qq ocaml ocaml-native-compilers camlp4-extra opam</code></pre></div>

<p>[NB: There are many <a href="https://launchpad.net/~avsm">other PPAs</a> for different combinations of
OCaml/Opam which are useful for testing].  Once the appropriate PPAs have
been set up it&#8217;s time to initialise Opam and install Mirage. </p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">export </span><span class="nv">OPAMYES</span><span class="o">=</span>1
opam init
opam install mirage
<span class="nb">eval</span> <span class="sb">`</span>opam config env<span class="sb">`</span></code></pre></div>

<p>We set <code>OPAMYES=1</code> to get non-interactive use of Opam (it defaults to &#8216;yes&#8217;
for any user input) and if we want full build logs, we could also set
<code>OPAMVERBOSE=1</code> (I haven&#8217;t in this example).
The rest should be straight-forward and you&#8217;ll end up with an
Ubuntu machine with OCaml, Opam and the Mirage package installed.  It&#8217;s now
trivial to do the next step of actually building the unikernel!</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">mirage configure --<span class="nv">$MIRAGE_BACKEND</span>
mirage build</code></pre></div>

<p>You can see how we&#8217;ve used the environment variable from the Travis file and
this is where our two parallel builds begin to diverge.  When you&#8217;ve saved
this file, you&#8217;ll need to change permissions to make it executable by doing
<code>$ chmod +x _mirage/travis.sh</code>.</p>

<p>That&#8217;s all you need to build the unikernel on Travis!  You should now commit
both the YAML file and the build script to the repo and push the changes to
GitHub.  Travis should automatically start your first build and you can
watch the console output online to check that both the Xen and Unix backends
complete properly.  If you notice any errors, you should go back over your
build script and fix it before the next step.</p>

<p><em>[NB: If you have a larger site, you may have to use a different file system
option for the configuration. Specifically,
*<code>$ FS=fat mirage configure --$MIRAGE_BACKEND</code></em>, which will crate a disk
image of the website content using the <a href="http://en.wikipedia.org/wiki/File_Allocation_Table">FAT file system</a> format
(<em><code>fat1.img</code></em>). This means you&#8217;ll also need to keep track of the disk image
for the deployment stage as your unikernel VM will connect to it. Look at the
<a href="https://github.com/nymote/nymote.github.io/blob/master/_mirage/travis.sh">nymote build script</a> for an example.]*</p>

<h2 id="deploying-your-unikernel">Deploying your unikernel</h2>
<p><img style="float: right; margin-left: 10px" src="http://amirchaudhry.com/images/jekyll-unikernel/octocat.png" />&lt;/img&gt;</p>

<p>When Travis has finished its builds it will simply destroy the worker and
all its contents, including the unikernels we just built.  This is perfectly
fine for testing but if we want to also <em>deploy</em> a unikernel, we need to get
it out of the Travis worker after it&#8217;s built. In this case, we want to
extract the Xen-based unikernel so that we can later start it on a Xen-based
machine (e.g Amazon, Rackspace or - in our case - a machine on <a href="http://www.bytemark.co.uk">Bytemark</a>).</p>

<p>Since the unikernel VMs are small (only tens of MB), our method for
exporting will be to commit the Xen unikernel into a repository on GitHub.
It can be retrieved and started later on and keeping the VMs in version
control gives us very effective snapshots (we can roll back the site without
having to rebuild).  This is something that would be much more challenging
if we were using the &#8216;standard&#8217; web toolstack.</p>

<p>The deployment step is a little more complex as we have to send the
Travis worker a private SSH key, which will give it push access to a GitHub
repository.  Of course, we don&#8217;t want to expose that key by simply adding it
to the Travis file so we have to encrypt it somehow. </p>

<h3 id="sending-travis-a-private-ssh-key">Sending Travis a private SSH key</h3>

<p>Travis supports <a href="http://docs.travis-ci.com/user/encryption-keys/">encrypted environment variables</a>. Each
repository has its own public key and the <a href="http://rubygems.org/gems/travis">Travis gem</a> uses
this public key to encrypt data, which you then add to your <code>.travis.yml</code>
file for decryption by the worker.  This is meant for sending things like
private API tokens and other small amounts of data. Trying to encrypt an SSH
key isn&#8217;t going to work as it&#8217;s too large.  Instead we&#8217;ll use
<a href="https://github.com/avsm/travis-senv">travis-senv</a>, which encodes, encrypts and chunks up the key into smaller
pieces and then reassembles those pieces on the Travis worker.  We still use
the Travis gem to encrypt the pieces to add them to the <code>.travis.yml</code> file.</p>

<p>While you could give Travis a key that accesses your whole GitHub account, my
preference is to create a <em>new</em> deploy key, which will only be used for
<a href="https://help.github.com/articles/managing-deploy-keys#deploy-keys">deployment to one repository</a>.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># make a key pair on your local machine</span>
<span class="nv">$ </span><span class="nb">cd</span> ~/.ssh/
<span class="nv">$ </span>ssh-keygen -t dsa -C <span class="s2">&quot;travis.deploy&quot;</span> -f travis-deploy_dsa
<span class="nv">$ </span><span class="nb">cd</span> -</code></pre></div>

<p>Note that this is a 1024 bit key so if you decide to use a 2048 bit key,
then be aware that Travis <a href="https://github.com/avsm/travis-senv/issues/1">sometimes has issues</a>. Now that we have
a key, we can encrypt it and add it to the Travis file. </p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># on your local machine</span>

<span class="c"># install the necessary components</span>
<span class="nv">$ </span>gem install travis
<span class="nv">$ </span>opam install travis-senv

<span class="c"># chunk the key, add to yml file and rm the intermediate</span>
<span class="nv">$ </span>travis-senv encrypt ~/.ssh/travis-deploy_dsa _travis_env
<span class="nv">$ </span>cat _travis_env <span class="p">|</span> travis encrypt -ps --add
<span class="nv">$ </span>rm _travis_env</code></pre></div>

<p><code>travis-senv</code> encrypts and chunks the key locally on your machine, placing
its output in a file you decide (<code>_travis_env</code>).  We then take that output
file and pipe it to the <code>travis</code> ruby gem, asking it to encrypt the input,
treating each line as separate and to be appended (<code>-ps</code>) and then actually
adding that to the Travis file (<code>--add</code>).  You can run <code>$ travis encrypt -h</code>
to understand these options.  Once you&#8217;ve run the above commands,
<code>.travis.yml</code> will look as follows.</p>

<div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">language</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">c</span>
<span class="l-Scalar-Plain">before_script</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">cd _mirage</span>
<span class="l-Scalar-Plain">script</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">bash -ex travis.sh</span>
<span class="l-Scalar-Plain">env</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">matrix</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">MIRAGE_BACKEND=xen DEPLOY=0</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">MIRAGE_BACKEND=unix</span>
  <span class="l-Scalar-Plain">global</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">secure</span><span class="p-Indicator">:</span> <span class="s">&quot;....</span><span class="nv"> </span><span class="s">encrypted</span><span class="nv"> </span><span class="s">data</span><span class="nv"> </span><span class="s">....&quot;</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">secure</span><span class="p-Indicator">:</span> <span class="s">&quot;....</span><span class="nv"> </span><span class="s">encrypted</span><span class="nv"> </span><span class="s">data</span><span class="nv"> </span><span class="s">....&quot;</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">secure</span><span class="p-Indicator">:</span> <span class="s">&quot;....</span><span class="nv"> </span><span class="s">encrypted</span><span class="nv"> </span><span class="s">data</span><span class="nv"> </span><span class="s">....&quot;</span>
  <span class="l-Scalar-Plain">...</span></code></pre></div>

<p>The number of secure variables added depends on the type and size of the key
you had to chunk, so it could vary from 8 up to 29. We&#8217;ll commit
these additions later on, alongside additions to the build script.</p>

<p>At this point, we also need to make a repository on GitHub
and add the public deploy key so
that Travis can push to it.  Once you&#8217;ve created your repo and added a
README, follow GitHub&#8217;s instructions on <a href="https://help.github.com/articles/managing-deploy-keys#deploy-keys">adding deploy keys</a>
and paste in the public key (i.e. the content of <code>travis-deploy_dsa.pub</code>).  </p>

<p>Now that we can securely pass a private SSH key to the worker
and have a repo that the worker can push to, we need to
make additions to the build script.</p>

<h3 id="committing-the-unikernel-to-a-repository">Committing the unikernel to a repository</h3>

<p>Since we can set <code>DEPLOY=1</code> in the YAML file we only need to make
additions to the build script.  Specifically, we want to assure that: only
the Xen backend is deployed; only <em>pushes</em> to the repo result in
deployments, not pull requests (we do still want <em>builds</em> for pull requests).</p>

<p>In the build script (<code>_mirage/travis.sh</code>), which is being run by the worker,
we&#8217;ll have to reconstruct the SSH key and configure Git.  In addition,
Travis gives us a set of useful <a href="http://docs.travis-ci.com/user/ci-environment/#Environment-variables">environment variables</a> so we&#8217;ll
use the latest commit hash (<code>$TRAVIS_COMMIT</code>) to name the the VM (which also
helps us trace which commit it was built from).</p>

<p>It&#8217;s easier to consider this section of code at once so I&#8217;ve explained the
details in the comments. This section is what you need to add at the end of
your existing build script (i.e straight after <code>mirage build</code>).</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Only deploy if the following conditions are met.</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;$MIRAGE_BACKEND&quot;</span> <span class="o">=</span> <span class="s2">&quot;xen&quot;</span> <span class="se">\</span>
            -a <span class="s2">&quot;$DEPLOY&quot;</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span> <span class="se">\</span>
            -a <span class="s2">&quot;$TRAVIS_PULL_REQUEST&quot;</span> <span class="o">=</span> <span class="s2">&quot;false&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>

    <span class="c"># The Travis worker will already have access to the chunks</span>
    <span class="c"># passed in via the yaml file. Now we need to reconstruct </span>
    <span class="c"># the GitHub SSH key from those and set up the config file.</span>
    opam install travis-senv
    mkdir -p ~/.ssh
    travis-senv decrypt &gt; ~/.ssh/id_dsa <span class="c"># This doesn&#39;t expose it</span>
    chmod <span class="m">600</span> ~/.ssh/id_dsa             <span class="c"># Owner can read and write</span>
    <span class="nb">echo</span> <span class="s2">&quot;Host some_user github.com&quot;</span>   &gt;&gt; ~/.ssh/config
    <span class="nb">echo</span> <span class="s2">&quot;  Hostname github.com&quot;</span>          &gt;&gt; ~/.ssh/config
    <span class="nb">echo</span> <span class="s2">&quot;  StrictHostKeyChecking no&quot;</span>     &gt;&gt; ~/.ssh/config
    <span class="nb">echo</span> <span class="s2">&quot;  CheckHostIP no&quot;</span>               &gt;&gt; ~/.ssh/config
    <span class="nb">echo</span> <span class="s2">&quot;  UserKnownHostsFile=/dev/null&quot;</span> &gt;&gt; ~/.ssh/config

    <span class="c"># Configure the worker&#39;s git details</span>
    <span class="c"># otherwise git actions will fail.</span>
    git config --global user.email <span class="s2">&quot;user@example.com&quot;</span>
    git config --global user.name <span class="s2">&quot;Travis Build Bot&quot;</span>

    <span class="c"># Do the actual work for deployment.</span>
    <span class="c"># Clone the deployment repo. Notice the user,</span>
    <span class="c"># which is the same as in the ~/.ssh/config file.</span>
    git clone git@some_user:amirmc/www-test-deploy
    <span class="nb">cd </span>www-test-deploy

    <span class="c"># Make a folder named for the commit. </span>
    <span class="c"># If we&#39;re rebuiling a VM from a previous</span>
    <span class="c"># commit, then we need to clear the old one.</span>
    <span class="c"># Then copy in both the config file and VM.</span>
    rm -rf <span class="nv">$TRAVIS_COMMIT</span>
    mkdir -p <span class="nv">$TRAVIS_COMMIT</span>
    cp ../mir-www.xen ../config.ml <span class="nv">$TRAVIS_COMMIT</span>

    <span class="c"># Compress the VM and add a text file to note</span>
    <span class="c"># the commit of the most recently built VM.</span>
    bzip2 -9 <span class="nv">$TRAVIS_COMMIT</span>/mir-www.xen
    git pull --rebase
    <span class="nb">echo</span> <span class="nv">$TRAVIS_COMMIT</span> &gt; latest    <span class="c"># update ref to most recent</span>

    <span class="c"># Add, commit and push the changes!</span>
    git add <span class="nv">$TRAVIS_COMMIT</span> latest
    git commit -m <span class="s2">&quot;adding $TRAVIS_COMMIT built for $MIRAGE_BACKEND&quot;</span>
    git push origin master
    <span class="c"># Go out and enjoy the Sun!</span>
<span class="k">fi</span></code></pre></div>

<p>At this point you should commit the changes to <code>./travis.yml</code> (don&#8217;t forget
the deploy flag) and <code>_mirage/travis.sh</code> and push the changes to GitHub.
Everything else will take place automatically and in a few minutes you will
have a unikernel ready to deploy on top of Xen! </p>

<p>You can see both the complete YAML file and build script in use on my
<a href="https://github.com/amirmc/www-test">test repo</a>, as well as the <a href="https://travis-ci.org/amirmc/www-test">build logs</a> for that repo
and the <a href="https://github.com/amirmc/www-test-deploy">deploy repo</a> with a VM.</p>

<p><em>[Pro-tip: If you add *<code>[skip ci]</code></em> anywhere in your
commit message, Travis will skip the build for that commit.
This is very useful if you&#8217;re making minor changes, like updating a
README.]*</p>

<h2 id="finishing-up">Finishing up</h2>

<p>Since I&#8217;m still using Jekyll for my website, I made a short script in my
jekyll repository (<code>_deploy-unikernel.sh</code>) that builds the site, commits the
contents of <code>_site</code> and pushes to GitHub. I simply run this after I&#8217;ve
committed a new blog post and the rest takes care of itself.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#!/usr/bin/env bash</span>
jekyll build
git add _site
git commit -m <span class="s1">&#39;update _site&#39;</span>
git push origin master</code></pre></div>

<p>Congratulations! You now have an end-to-end workflow that will produce a
unikernel VM from your Jekyll-based site and push it to a repo.  If you
strip out all the comments, you&#8217;ll see that we&#8217;ve written less than 50 lines
of code! Admittedly, I&#8217;m not counting the 80 or so lines that came for free
in the <code>*.ml</code> files but that&#8217;s still pretty impressive.</p>

<p>Of course, we still need a machine to take that VM and run it but that&#8217;s a
topic for another post.  For the time-being, I&#8217;m still using GitHub Pages
but once the VM is hosted somewhere, I will:</p>

<ol>
  <li>Turn off GitHub Pages and serve from the VM &#8211; but still using Jekyll in
the workflow.</li>
  <li>Replace Jekyll with OCaml-based static-site generation.</li>
</ol>

<p>Although all the tools already exist to switch now, I&#8217;m taking my time so
that I can easily maintain the code I end up using.</p>

<h2 id="expanding-the-script-for-testing">Expanding the script for testing</h2>

<p>You may have noticed that the examples here are not very flexible or
extensible but that was a deliberate choice to keep them readable.  It&#8217;s
possible to do much more with the build matrix and script, as you can see
from the Travis files on my <a href="https://github.com/amirmc/amirmc.github.com/tree/master/_mirage">website repo</a>, which were based on
those of the <a href="https://github.com/mirage/mirage-www">Mirage site</a> and <a href="https://github.com/mor1/mort-www">Mort&#8217;s site</a>.
Specifically, you can note the use of more environment variables and case
statements to decide which PPAs to grab.  Once you&#8217;ve got your builds
working, it&#8217;s worth improving your scripts to make them more maintainable
and cover the test cases you feel are important.</p>

<h3 id="not-just-for-static-sites-surprise">Not just for static sites (surprise!)</h3>

<p>You might have noticed that in very few places in the toolchain above have I
mentioned anything specific to static sites per se.  The workflow is simply
(1) do some stuff locally, (2) push to a continuous integration service
which then (3) builds and deploys a Xen-based unikernel.  Apart from the
convenient folder structure, the specific work to treat this as a static
site lives in the <code>*.ml</code> files, which I&#8217;ve skipped over for this post.  </p>

<p>As such, the GitHub+Travis workflow we&#8217;ve developed here is quite general
and will apply to almost <em>any</em> unikernels that we may want to construct.
I encourage you to explore the examples in the <a href="https://github.com/mirage/mirage-skeleton">mirage-skeleton</a> repo and
keep your build script maintainable.  We&#8217;ll be using it again the next time
we build unikernel devices.</p>

<hr />

<p><em>Acknowledgements:</em> There were lots of things I read over while writing this
post but there were a few particularly useful things that you should look up.
Anil&#8217;s posts on <a href="http://anil.recoil.org/2013/09/30/travis-and-ocaml.html">Testing with Travis</a> and
<a href="http://anil.recoil.org/2013/10/06/travis-secure-ssh-integration.html">Travis for secure deployments</a> are quite succinct (and
were themselves prompted by <a href="http://blog.mlin.net/2013/02/testing-ocaml-projects-on-travis-ci.html">Mike Lin&#8217;s Travis post</a> several
months earlier). Looking over Mort&#8217;s <a href="https://github.com/mor1/mort-www/blob/master/.travis-build.sh">build script</a> and that of
<a href="https://github.com/mirage/mirage-www/blob/master/.travis-ci.sh">mirage-www</a> helped me figure out the deployment steps as well as improve
my own script. Special thanks also to <a href="http://erratique.ch">Daniel</a>, <a href="http://www.lpw25.net">Leo</a> and <a href="http://anil.recoil.org">Anil</a> for
commenting on an earlier draft of this post.</p>

<p>This post was previously published on my <a href="http://amirchaudhry.com/from-jekyll-to-unikernel-in-fifty-lines/">personal site</a>.</p>


                <a href="/blog/2014/from-jekyll-site-to-unikernel/#share-comment"><!-- Share / -->Comment</a>
              </div>
              <hr>
            </div>
          </div>  
          
          <div class="page-header">
            <h1><a class="post-title" href="/blog/2014/fosdem-summary">Summary of FOSDEM 2014</a></h1>
            <span>Posted on 11 February 2014 by Amir Chaudhry</span>
            
          </div>
          <div class="row">
            <div class="span10">
              <div class="title-page">
                <h4 class="title-description"></h4>
                
<p>It&#8217;s been just over a week since FOSDEM ended and it was even more hectic 
than we imagined.  Thousands of open source developers across dozens of 
rooms and speakers and lots of delicious waffles.  I&#8217;m still in awe that 
this is a completely volunteer organised event and that everything appeared 
to run smoothly.  Especially, since this has to be the <em>only</em> conference 
I&#8217;ve been at where the wifi was usable (and ubiquitous).  </p>

<p>The most interesting aspect was how crowded some of the rooms became and how 
quickly.  For example, the <a href="https://fosdem.org/2014/schedule/track/configuration_management/">configuration management track</a> was 
pretty much full throughout the day with a crowd of people trying to get in.
I heard that the Mozilla track was equally busy as were some other devrooms.
This may be in indication of relative popularity but also the sheer scale 
that this annual event has reached. It may be outgrowing ULB.  Thankfully, 
<a href="https://fosdem.org/2014/news/2014-02-03-videos/">videos will be available</a> this year so I hope I can catchup 
up with the sessions I couldn&#8217;t get to!  One that I was particularly 
interested in is the <a href="http://www.xenproject.org/developers/teams/arm-hypervisor.html">Xen/ARM</a> talk in the <a href="https://fosdem.org/2014/schedule/track/automotive_development/">Automotive track</a>.
Since cars are now getting smarter and Xen works on embedded devices it 
would be an excellent use case for Mirage to ensure that the software 
running in vehicles is safe and does only what it&#8217;s supposed to.  There were 
many other Xen talks too and you catchup with them on the 
<a href="http://blog.xen.org/index.php/2014/02/07/xen-fosdem14-an-even-report/">Xen blog</a>.</p>

<p>The Mail track talks were crowded and during the 
<a href="https://fosdem.org/2014/schedule/track/mail/">postfix talk</a> we were treated to an interesting review of 
spam around the globe, which was followed up by the Mailpile team announcing 
their <a href="https://www.mailpile.is/blog/2014-01-31_Alpha_Release_Shipping_Bits_and_Atoms.html">alpha release</a> on stage! The 
<a href="https://fosdem.org/2014/schedule/track/internet_of_things/">Internet of Things devroom</a> had a number of interesting talks 
but there need to be more people thinking about the underlying 
infrastructure needs before we can begin building resilient, decentralised 
networks.</p>

<p>For the Mirage talk, Mort and Anil gave a great demo by building unikernels 
on stage to show the process in action.  They continued the demos at the Xen 
stall to a number of people including some surprisingly young FOSDEM 
attendees.  We&#8217;ll soon be moving our personal websites to become self-hosted 
unikernels, and from there we can build out more of the Nymote toolstack.</p>

<p>We&#8217;ve captured some of the interesting tweets and pictures below and 
hopefully next year we&#8217;ll be speaking at FOSDEM about how we&#8217;re using the 
Nymote toolstack.</p>

<div class="storify">&lt;iframe src="//storify.com/amirmc/fosdem/embed?header=false&amp;border=false" width="100%" height=750 frameborder=no allowtransparency=true&gt;<script src="//storify.com/amirmc/fosdem.js?header=false&amp;border=false"></script><noscript>[<a href="//storify.com/amirmc/fosdem" target="_blank">View the story "Summary of FOSDEM 2014" on Storify</a>]</noscript></div>

                <a href="/blog/2014/fosdem-summary/#share-comment"><!-- Share / -->Comment</a>
              </div>
              <hr>
            </div>
          </div>  
          
          <div class="page-header">
            <h1><a class="post-title" href="/blog/2014/heading-to-fosdem-2014">Heading to FOSDEM!</a></h1>
            <span>Posted on 30 January 2014 by Amir Chaudhry</span>
            
          </div>
          <div class="row">
            <div class="span10">
              <div class="title-page">
                <h4 class="title-description"></h4>
                
<p>We&#8217;re heading to <a href="https://fosdem.org/2014/">FOSDEM</a> in a few days!  If you haven&#8217;t heard of FOSDEM 
before, it&#8217;s a two-day, volunteer-organised event to promote open source 
software.  It takes place in Brussels and there will be over 500 talks, 
across 44 tracks attended by around 5000 people. The numbers alone don&#8217;t 
capture the scale of the event so click though the image below for a view of 
the schedule &#8211; and that&#8217;s just for the Saturday. Did I mention this is all 
run by volunteers?</p>

<p><a href="https://fosdem.org/2014/schedule/day/saturday/"><img src="http://nymote.org/images/fosdem-sat.jpg" alt="FOSDEM on Saturday" /></a></p>

<p>We&#8217;ll be meeting a bunch of like-minded people in the various sessions and 
talking more about how the Nymote stack is progressing, especially as Mirage 
is gaining momentum after the <a href="http://nymote.org/blog/2014/announcing-first-mirage-release/">1.0 release</a>.  Anil and Mort 
will be giving a talk about Mirage on Sunday at 1pm (<a href="https://fosdem.org/2014/schedule/event/mirageos/">details</a>) 
and also giving demos at the Xen Booth from 2:30pm-4:30pm (in Building K on 
the 1st floor).  Since deployment to embedded systems is also important, 
we&#8217;re interested in open source efforts on ARM devices like the 
<a href="https://fosdem.org/2014/schedule/event/arm_allwinner_sunxi_socs/">Allwinner SoC community</a> &#8211; especially since Anil has been hacking 
on <a href="http://www.xenproject.org/developers/teams/arm-hypervisor.html">Xen/ARM</a> on a cubieboard. There are a number of other Xen-related 
talks and you can find out more from the <a href="http://blog.xen.org/index.php/2014/01/10/xen-related-talks-fosdem-2014/">Xen blog</a>.  </p>

<p>Given the use-cases for Nymote, there are some obvious places you can expect 
to find us.  On Saturday there&#8217;s the <a href="https://fosdem.org/2014/schedule/track/mail/">Mail track</a>, where we&#8217;ll 
be discussing existing tools and catching up up with the Mailpile guys, who 
we last <a href="http://nymote.org/blog/2013/indiewebcamp-uk/">met at IndieWebCamp</a>.  On the Sunday, there&#8217;s the 
<a href="https://fosdem.org/2014/schedule/track/internet_of_things/">Internet of Things dev-room</a>, where we&#8217;ll bring up the upcoming 
problems we see regarding centralised IoT services and how Nymote will 
change this.  In addition, a colleague from the lab, <a href="http://www.cl.cam.ac.uk/~jra40/">Jon Anderson</a>,
is speaking about security and the <a href="http://www.cl.cam.ac.uk/research/security/capsicum/">Capscium project</a>, which is 
relevant for sandboxing security (<a href="https://fosdem.org/2014/schedule/event/capiscum/">details</a>).</p>

<p>We&#8217;ll be writing up our experiences shortly after we return and in the 
meantime, the real issue will be deciding which sessions to go to.  If 
you&#8217;re in Brussels for that weekend do get in touch with us!  We love to 
meet people working towards the same goals.</p>


                <a href="/blog/2014/heading-to-fosdem-2014/#share-comment"><!-- Share / -->Comment</a>
              </div>
              <hr>
            </div>
          </div>  
          

          <h3><a href="/archive/">More posts</a></h3>
        </div>
      </div>
    </div>
  </div>
</div>

      
      


    <!-- Footer -->
    <footer>
      <div class="container" id="footer">
        <div class="row bordertop">
          <div class="span6 footertext">
            <span class="icon-github" style="float: left; font-size: 60px;"></span>
            <div class="span3">Find us on <a href="https://github.com/nymote" target="_blank">GitHub</a> <br/> or send us an <a href="mailto:amir@nymote.com">email</a><p></p></div>
          </div>
          <div class="span6">
            <div class="icon">
              <span class="icon-inbox" style="float: left; margin-top: 19px; font-size: 60px;"></span>
            </div>
            <!--- Begin MailChimp Signup Form -->
<link href="http://cdn-images.mailchimp.com/embedcode/slim-081711.css" rel="stylesheet" type="text/css" />
<style type="text/css">
  #mc_embed_signup{background-color:transparent; clear:right; font:14px Helvetica,Arial,sans-serif; }
  <!--- /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
  We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */ -->
  .footeremail {width:100%;}
</style>
<div id="mc_embed_signup">
  <form action="http://nymote.us5.list-manage.com/subscribe/post?u=8a83b2d5453bba2ee5838b4ad&amp;id=a41245094c" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank">
    <div class="text" style="margin: 10px; margin-left: 73px;">Signup to our newsletter</div>
    <div class="span3">
      <input type="email" value="" name="EMAIL" class="footeremail" placeholder="email address" style="width: 100%; padding: 15px;">
    </div>
    <div class="span2"><div class="clear">
      <input type="submit" class="subscribebutton" value="Subscribe" name="subscribe" style="padding: 6px;">
    </div>
    </div>
  </form>
</div>
<!-- End mc_embed_signup -->        
          </div>
      </div>
    </footer>
    <!-- End Footer -->


    <!-- JAVASCRIPT -->
    <script src="/assets/themes/twitter-mod/js/modernizr.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script> <!-- jQuery Core -->
    <script src="/assets/themes/twitter-mod/js/bootstrap.min.js"></script> <!-- Bootstrap -->
    <script src="/assets/themes/twitter-mod/js/supersized.3.2.7.min.js"></script> <!-- Slider -->
    <script src="/assets/themes/twitter-mod/js/waypoints.js"></script> <!-- WayPoints -->
    <script src="/assets/themes/twitter-mod/js/waypoints-sticky.js"></script> <!-- Waypoints for Header -->
    <script src="/assets/themes/twitter-mod/js/jquery.isotope.js"></script> <!-- Isotope Filter -->
    <script src="/assets/themes/twitter-mod/js/jquery.fancybox.pack.js"></script> <!-- Fancybox -->
    <script src="/assets/themes/twitter-mod/js/jquery.fancybox-media.js"></script> <!-- Fancybox for Media -->
    <script src="/assets/themes/twitter-mod/js/jquery.tweet.js"></script> <!-- Tweet -->
    <script src="/assets/themes/twitter-mod/js/plugins.js"></script> <!-- Contains: jPreloader, jQuery Easing, jQuery ScrollTo, jQuery One Page Navi -->
    <script src="/assets/themes/twitter-mod/js/main.js"></script> <!-- Default JS -->
    <!-- unused -->
    <!--<script src="https://maps.googleapis.com/maps/api/js?sensor=true"></script>--> <!-- Google Map API -->
    
  </body>
</html>

